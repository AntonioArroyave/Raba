; Generated by AutoGUI 2.1.7a
#NoEnv
#SingleInstance Force
SetWorkingDir %A_ScriptDir%

Menu Tray, Icon, shell32.dll, 201

Gui Add, Button, gconfigurar x358 y325 w80 h23, Configurar
Gui Add, Button, gverificar x208 y325 w80 h23, Verificar 
Gui Add, Tab3, x15 y9 w445 h208, Variable Paths|Programs to install
Gui Tab, 1
Gui Add, Text, x28 y43 w100 h26 +0x200, Rabapath
Gui Add, Edit, hWndrabapath veditrabapath x140 y45 w200 h21
Gui Add, Button, gbotonrabapth x354 y45 w80 h23, Edit
Gui Add, Text, x28 y80 w100 h26 +0x200, Documentos
Gui Add, Edit, veditdocumentos x143 y79 w200 h21
Gui Add, Button, gbotondocumentos x353 y77 w80 h23, Edit
Gui Tab, 2
Gui Add, CheckBox, vOptVim x35 y46 w120 h23, Vim
Gui Add, CheckBox, vOptChocolatey x35 y78 w120 h23, Chocolatey
Gui Add, CheckBox, vOptAutoHotKey x35 y112 w120 h23, AutoHotKey
Gui Add, CheckBox, vOptPython x35 y144 w120 h23, Python

Gui Show, w481 h381, Window
Return

GuiEscape:
GuiClose:
ExitApp

; Do not edit above this line

botonrabapth:
{
FileSelectFolder, rabapath
GuiControl,, editrabapath, %rabapath% 
return
}
botondocumentos:
{
FileSelectFolder, documentos
GuiControl,, editdocumentos, %documentos% 
return
}
configurar:
{   
RunWait *RunAs rabainstall.bat %A_ScriptDir% %documentos% ,, Hide
return
}
verificar:
{
Gui Submit
	if  %OptChocolatey% {
		EnvGet checkChocolatey, ChocolateyInstall
		if !checkChocolatey {
			MsgBox, Chocolatey is not Install
			RunWait, *RunAs %comspec% /c "@"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))" && SET "PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin"" ,, Max
		} else { MsgBox, Choclatey is intall on %checkChocolatey% 
		}
 	}
	if %OptAutoHotKey% {
		chekAhk := RunWaitOne("reg query HKEY_CLASSES_ROOT\AutoHotkeyScript\Shell\RunAs\Command")
		if %chekAhk% {
			MsgBox, Auto hot key is install
		} else { 
		;	MsgBox, Auto hot key is not install
			RunWait, *RunAs %comspec% /c "choco install autohotkey"
		}
	}
	if %OptVim% {
		checkVim := RunWaitOne("vim --version")
		if %checkVim% {
			MsgBox, Vim ya ha sido instalado	
		} else {
			MsgBox, Vim no ha sido instalado
			;RunWait, *RunAs %comspec% /c "choco install vim"
		}
	} 
return
}
RunWaitOne(command) {
    ; WshShell object: http://msdn.microsoft.com/en-us/library/aew9yb99
    shell := ComObjCreate("WScript.Shell")
    ; Execute a single command via cmd.exe
    exec := shell.Exec(ComSpec " /C " command)
    ; Read and return the command's output
    return exec.StdOut.ReadAll()
}
